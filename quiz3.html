<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Ninja Quiz</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Import Google Font - Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        /* Base styles for body */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f0f0; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            overflow: hidden; /* Prevent scrollbars */
        }

        /* Main container for the game/quiz */
        .game-container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 90%;
            max-width: 700px;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease-out; /* Fade-in animation for the container */
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Keyframe animation for fading in elements */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header section styling */
        .main-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 10px; /* Add some padding to the header */
            box-sizing: border-box;
        }

        /* Header control buttons (Home button) */
        .header-controls button {
            background-color: transparent;
            color: #555;
            border: 1px solid #ccc;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .header-controls button:hover {
            background-color: #eee;
            color: #222;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* Logo styling */
        .logo {
            font-size: 2.5em;
            color: #222; /* Dark gray */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 700;
            flex-grow: 1; /* Allow logo to take available space */
        }

        .logo i {
            color: #555; /* Medium gray for icons */
        }

        /* General heading styles */
        h1, h2, h3 {
            color: #222; /* Dark gray */
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        /* Start screen specific styles */
        .start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        .start-screen h1 {
            font-size: 2.2em; /* Slightly larger for emphasis */
            margin-bottom: 15px;
        }

        .start-screen p {
            font-size: 1.1em;
            color: #555;
            max-width: 80%; /* Constrain text width */
            margin-bottom: 30px;
            line-height: 1.5;
        }

        /* Common button styles for start, navigation, result, and submit */
        .start-screen button, .quiz-navigation button, .result-screen button, .submit-quiz-button {
            background-color: #333; /* Dark gray */
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            margin-top: 20px;
        }

        .start-screen button:hover, .quiz-navigation button:hover, .result-screen button:hover, .submit-quiz-button:hover {
            background-color: #555; /* Lighter gray on hover */
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .start-screen button:active, .quiz-navigation button:active, .result-screen button:active, .submit-quiz-button:active {
            transform: translateY(0);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
        }

        /* Quiz area specific styles */
        .quiz-area {
            display: none; /* Hidden by default */
            width: 100%;
            flex-direction: column; /* Ensure content stacks vertically */
            align-items: center;
        }

        .question-counter {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 15px;
        }

        .question-box {
            background-color: #f8f8f8; /* Very light gray */
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: left; /* Align text to the left within the box */
            width: 100%; /* Take full width of parent */
            box-sizing: border-box; /* Include padding in width */
        }

        .question-text {
            font-size: 1.3em;
            margin-bottom: 20px;
            font-weight: 600;
            color: #343a40;
            text-align: center; /* Center question text */
            width: 100%;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 10px;
        }

        /* Individual option button for MCQs */
        .option-button {
            background-color: #f0f0f0; /* Light gray */
            border: 1px solid #d0d0d0;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            font-size: 1em;
            color: #495057;
            width: 100%; /* Full width */
            box-sizing: border-box;
        }

        .option-button:hover:not(.correct):not(.incorrect):not(.disabled) {
            background-color: #e0e0e0; /* Slightly darker gray on hover */
            border-color: #c0c0c0;
        }

        /* Styles for selected, correct, and incorrect options */
        .option-button.selected {
            background-color: #333; /* Dark gray for selected */
            color: white;
            border-color: #333;
        }

        .option-button.correct {
            background-color: #28a745; /* Desaturated green */
            color: white;
            border-color: #28a745;
        }

        .option-button.incorrect {
            background-color: #dc3545; /* Desaturated red */
            color: white;
            border-color: #dc3545;
        }

        .option-button.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Explanation box for correct/incorrect answers */
        .explanation-box {
            background-color: #e6f7ff; /* Light blue */
            border: 1px solid #91d5ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: left;
            color: #004085;
            font-size: 0.95em;
            display: none; /* Hidden by default */
            width: 100%;
            box-sizing: border-box;
        }

        /* Short answer input field */
        .short-answer-input {
            width: calc(100% - 20px); /* Adjust for padding */
            padding: 12px 10px;
            border: 1px solid #d0d0d0;
            border-radius: 8px;
            font-size: 1em;
            margin-top: 10px;
            resize: vertical;
            min-height: 80px;
            color: #333;
            background-color: #f8f8f8;
            box-sizing: border-box;
        }

        /* Self-marking section for SAQ */
        .self-mark-section {
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }

        .self-mark-section h3 {
            color: #222;
            margin-bottom: 15px;
        }

        .model-answer {
            background-color: #f0f0f0; /* Light gray */
            border: 1px solid #d0d0d0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: left;
            color: #333;
            font-style: italic;
        }

        .self-mark-buttons button {
            background-color: #555; /* Medium gray */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.95em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 0 5px;
        }

        .self-mark-buttons button.correct-mark.selected-mark {
            background-color: #28a745; /* Desaturated green when selected */
        }

        .self-mark-buttons button.incorrect-mark.selected-mark {
            background-color: #dc3545; /* Desaturated red when selected */
        }

        .self-mark-buttons button:hover {
            opacity: 0.9;
        }

        /* Submit quiz button */
        .submit-quiz-button {
            background-color: #222; /* Darker gray for submit */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            margin-top: 20px; /* Add margin to separate from self-mark section */
        }

        .submit-quiz-button:hover {
            background-color: #000; /* Black on hover */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* Quiz navigation buttons (Previous/Next) */
        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }

        .quiz-navigation button {
            margin: 0;
            padding: 10px 20px;
            font-size: 1em;
            box-shadow: none;
        }

        .quiz-navigation button:hover {
            transform: none;
            box-shadow: none;
        }

        /* Result screen styles */
        .result-screen {
            display: none; /* Hidden by default */
            width: 100%;
            flex-direction: column;
            align-items: center;
        }

        .result-screen h2 {
            color: #222;
            margin-bottom: 20px;
        }

        .score {
            font-size: 2.5em;
            font-weight: 700;
            color: #28a745; /* Green for score */
            margin-bottom: 20px;
        }

        .feedback {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 30px;
        }

        /* Summary chart section */
        .summary-section {
            width: 100%;
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .summary-section h3 {
            margin-bottom: 20px;
            color: #222;
        }

        .chart-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 400px;
            margin: 0 auto 20px auto;
            text-align: left;
        }

        .chart-bar-wrapper {
            display: flex;
            align-items: center;
            font-size: 0.9em;
            color: #555;
        }

        .chart-label {
            width: 80px;
            flex-shrink: 0;
            font-weight: 600;
        }

        .chart-bar {
            height: 25px;
            border-radius: 5px;
            transition: width 0.5s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .chart-bar.correct {
            background-color: #28a745; /* Desaturated green */
        }

        .chart-bar.incorrect {
            background-color: #dc3545; /* Desaturated red */
        }

        .chart-bar.unanswered {
            background-color: #888; /* Gray */
        }

        /* Detailed review section */
        .detailed-review-section {
            width: 100%;
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            text-align: left;
        }

        .detailed-review-section h3 {
            text-align: center;
            margin-bottom: 20px;
        }

        .review-item {
            background-color: #f8f8f8;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .review-item p {
            margin-bottom: 5px;
            color: #333;
        }

        .review-item .question-text-review {
            font-weight: 600;
            color: #343a40;
            margin-bottom: 10px;
        }

        .review-item .your-answer, .review-item .correct-answer, .review-item .model-answer-review {
            font-size: 0.95em;
            margin-left: 10px;
            margin-bottom: 5px;
        }

        .review-item .your-answer {
            color: #dc3545; /* Red for incorrect user answer */
        }

        .review-item .correct-answer {
            color: #28a745; /* Green for correct answer */
        }

        .review-item .model-answer-review {
            color: #004085; /* Blue for model answer */
            font-style: italic;
        }

        .revision-suggestions-section {
            width: 100%;
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            text-align: center;
        }

        .revision-suggestions-section h3 {
            margin-bottom: 15px;
        }

        .revision-suggestions-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .revision-suggestions-section li {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 8px;
            padding: 8px 15px;
            color: #004085;
            font-size: 0.9em;
            font-weight: 500;
        }


        /* Custom message box for alerts */
        .message-box {
            display: none; /* Hidden by default */
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 2px solid #555; /* Darker gray border */
        }

        .message-box h3 {
            color: #333;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .message-box p {
            margin-bottom: 20px;
            color: #333;
        }

        .message-box button {
            background-color: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .message-box button:hover {
            background-color: #555;
        }

        /* Copyright text */
        .copyright {
            margin-top: 30px;
            font-size: 0.8em;
            color: #888;
        }

        /* Responsive adjustments for smaller screens (max-width: 768px) */
        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
                width: 95%;
            }

            .main-header {
                flex-direction: column;
                gap: 10px;
            }

            .header-controls {
                position: static; /* Remove absolute positioning */
                width: 100%;
                text-align: right;
            }

            .logo {
                font-size: 2em;
            }

            h1 {
                font-size: 1.5em;
            }

            .start-screen p {
                max-width: 95%;
            }

            .start-screen button, .quiz-navigation button, .result-screen button, .submit-quiz-button {
                padding: 12px 25px;
                font-size: 1em;
            }

            .question-text {
                font-size: 1.1em;
            }

            .options-container {
                gap: 8px; /* Slightly smaller gap for options */
            }

            .option-button {
                padding: 10px 12px;
                font-size: 0.9em;
            }

            .quiz-navigation {
                flex-direction: column;
                gap: 15px;
            }

            .quiz-navigation button {
                width: 100%;
            }

            .chart-label {
                width: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="main-header">
            <div class="logo">
                <i class="fas fa-server"></i> Network Ninja Quiz <i class="fas fa-brain"></i>
            </div>
            <div class="header-controls">
                <button id="homeButton"><i class="fas fa-home"></i> Home</button>
            </div>
        </div>

        <div class="start-screen" id="startScreen">
            <h1>Test Your Network Knowledge!</h1>
            <p>Answer questions about network communication and components. Some questions are multiple choice, others require a short answer.</p>
            <button id="startButton">Start Quiz</button>
        </div>

        <div class="quiz-area" id="quizArea">
            <div class="question-counter" id="questionCounter">Question 1 of 10</div>
            <div class="question-box">
                <p class="question-text" id="questionText"></p>
                <div class="options-container" id="optionsContainer">
                    </div>
                <textarea class="short-answer-input" id="shortAnswerInput" placeholder="Type your answer here..." style="display: none;"></textarea>
                <div class="explanation-box" id="explanationBox"></div> </div>

            <div class="self-mark-section" id="selfMarkSection" style="display: none;">
                <h3>Model Answer:</h3>
                <div class="model-answer" id="modelAnswer"></div>
                <p>Did your answer match the model answer?</p>
                <div class="self-mark-buttons">
                    <button class="correct-mark" data-mark="correct">Yes, it matched!</button>
                    <button class="incorrect-mark" data-mark="incorrect">No, it didn't.</button>
                </div>
            </div>

            <button id="submitQuiz" class="submit-quiz-button" style="display: none;">Submit Quiz</button>

            <div class="quiz-navigation">
                <button id="prevButton" style="display: none;">Previous</button>
                <button id="nextButton">Next Question</button>
            </div>
        </div>

        <div class="result-screen" id="resultScreen">
            <h2>Quiz Complete!</h2>
            <p class="score" id="finalScore">Score: 0/0</p>
            <p class="feedback" id="feedbackMessage"></p>

            <div class="summary-section">
                <h3>Quiz Summary</h3>
                <div class="chart-container" id="summaryChart">
                    </div>
            </div>

            <div class="detailed-review-section" id="detailedReviewSection" style="display: none;">
                <h3>Detailed Review of Missed Questions</h3>
                <div id="reviewItemsContainer">
                    </div>
            </div>

            <div class="revision-suggestions-section" id="revisionSuggestionsSection" style="display: none;">
                <h3>Suggested Topics for Revision</h3>
                <ul id="revisionTopicsList">
                    </ul>
            </div>

            <button id="restartButton">Play Again</button>
        </div>

        <div class="copyright">
            &copy; 2025 Nachiketh Reddy. All rights reserved.
        </div>
    </div>

    <div class="message-box" id="messageBox">
        <h3 id="messageBoxTitle"></h3>
        <p id="messageBoxContent"></p>
        <button id="messageBoxClose">OK</button>
    </div>

    <script>
        // Array of quiz questions
        const quizQuestions = [
            // Multiple Choice Questions (MCQ)
            {
                type: "mcq",
                question: "Which of the following is NOT a hardware component?",
                options: ["Motherboard", "Solid State Drive (SSD)", "Random Access Memory (RAM)", "Microsoft Windows"],
                correctAnswer: "Microsoft Windows",
                explanation: "Microsoft Windows is an operating system, which is software, not hardware.",
                topic: "Hardware vs Software"
            },
            {
                type: "mcq",
                question: "Which of the following is part of the Network Communication Layer?",
                options: ["User Application", "Network Interface", "Network Protocol", "All of the above"],
                correctAnswer: "All of the above",
                explanation: "The layers of network communication include User Application, Network Software, Network Protocol, and Network Interface.",
                topic: "Network Layers"
            },
            {
                type: "mcq",
                question: "Which of the following statement is true about a Switch?",
                options: ["Switch cannot create a Local Area Network (LAN).", "Switch contains a switching table.", "Switch communicates with IP addresses.", "Switch is a Hub."],
                correctAnswer: "Switch contains a switching table.",
                explanation: "Switches are intelligent devices that use a switching table (based on MAC addresses) to forward data only to the intended recipient, unlike hubs which broadcast to all ports.",
                topic: "Networking Devices"
            },
            {
                type: "mcq",
                question: "Which of the following defines bandwidth in a network?",
                options: ["Transmission capacity of a communication channel.", "Connected computers in the network.", "Class of IP used in network.", "Type of manufacturer used in network."],
                correctAnswer: "Transmission capacity of a communication channel.",
                explanation: "Bandwidth refers to the maximum rate at which data can be transferred over a communication channel.",
                topic: "Network Concepts"
            },
            {
                type: "mcq",
                question: "The header of the Internet Protocol (IP) packet includes which of the following?",
                options: ["Only source IP address.", "Only destination IP address.", "Source and destination IP address.", "Source and destination MAC address."],
                correctAnswer: "Source and destination IP address.",
                explanation: "An IP packet header contains both the source and destination IP addresses, enabling routing across networks.",
                topic: "IP Addressing"
            },
            {
                type: "mcq",
                question: "What is the primary function of a Network Interface Card (NIC)?",
                options: ["To store network configurations.", "To translate signals between the computer and the network medium.", "To manage network traffic congestion.", "To assign IP addresses to devices."],
                correctAnswer: "To translate signals between the computer and the network medium.",
                explanation: "A NIC is essential for a computer to connect to a network, handling the conversion of data into signals for transmission and vice-versa.",
                topic: "Networking Devices"
            },
            {
                type: "mcq",
                question: "What is the main difference between a Hub and a Switch regarding data transmission?",
                options: ["A Hub sends data to a specific port, while a Switch broadcasts data to all ports.", "A Hub broadcasts data to all ports, while a Switch sends data only to the intended recipient.", "A Hub uses IP addresses, while a Switch uses MAC addresses.", "There is no significant difference."],
                correctAnswer: "A Hub broadcasts data to all ports, while a Switch sends data only to the intended recipient.",
                explanation: "Hubs are less intelligent and broadcast all incoming data to every connected device, leading to network congestion. Switches are smarter, using MAC addresses to direct data only to the relevant port.",
                topic: "Networking Devices"
            },
            {
                type: "mcq",
                question: "What does CIDR IP address 192.168.1.0/24 signify?",
                options: ["The first 8 bits cannot be touched.", "The first 16 bits cannot be touched.", "The first 24 bits cannot be touched.", "The last 8 bits cannot be touched."],
                correctAnswer: "The first 24 bits cannot be touched.",
                explanation: "In CIDR notation, /24 means that the first 24 bits of the IP address are fixed for the network portion, and cannot be changed for host addressing.",
                topic: "IP Addressing"
            },
            {
                type: "mcq",
                question: "What is the purpose of a 'default route' in a router?",
                options: ["To set a static IP address.", "To send a packet when the router doesn't have an entry in its routing tables.", "To block all incoming traffic.", "To prioritize certain network traffic."],
                correctAnswer: "To send a packet when the router doesn't have an entry in its routing tables.",
                explanation: "A default route specifies where to send packets for which the router has no specific route entry in its routing table, acting as a 'route of last resort'.",
                topic: "Routing"
            },
            {
                type: "mcq",
                question: "What is the role of a 'client' in a network environment?",
                options: ["To provide resources to other computers.", "To request information or resources from a server.", "To manage network security.", "To route data between networks."],
                correctAnswer: "To request information or resources from a server.",
                explanation: "A client is typically a device or software that initiates requests for services or resources from a server.",
                topic: "Network Roles"
            },
            {
                type: "mcq",
                question: "Which protocol is used for secure web browsing?",
                options: ["HTTP", "FTP", "HTTPS", "SMTP"],
                correctAnswer: "HTTPS",
                explanation: "HTTPS (Hypertext Transfer Protocol Secure) is the secure version of HTTP, using SSL/TLS for encryption.",
                topic: "Network Protocols"
            },
            {
                type: "mcq",
                question: "What is a firewall primarily used for?",
                options: ["To boost internet speed.", "To prevent unauthorized access to a network.", "To manage wireless connections.", "To store user data."],
                correctAnswer: "To prevent unauthorized access to a network.",
                explanation: "A firewall acts as a barrier, controlling incoming and outgoing network traffic based on security rules.",
                topic: "Network Security"
            },
            {
                type: "mcq",
                question: "Which of the following is an example of a Wide Area Network (WAN)?",
                options: ["A home Wi-Fi network.", "A school's local network.", "The Internet.", "A small office network."],
                correctAnswer: "The Internet.",
                explanation: "A WAN covers a broad area (e.g., across cities, countries) and is typically used to connect multiple smaller networks, like the Internet.",
                topic: "Network Types"
            },
            {
                type: "mcq",
                question: "What is the purpose of DNS (Domain Name System)?",
                options: ["To assign IP addresses dynamically.", "To translate domain names into IP addresses.", "To secure network connections.", "To manage email services."],
                correctAnswer: "To translate domain names into IP addresses.",
                explanation: "DNS acts like a phonebook for the internet, translating human-readable domain names (like google.com) into machine-readable IP addresses.",
                topic: "Network Protocols"
            },
            {
                type: "mcq",
                question: "What is latency in network communication?",
                options: ["The amount of data that can be transmitted.", "The delay before a transfer of data begins following an instruction for its transfer.", "The speed at which data travels.", "The number of devices connected to a network."],
                correctAnswer: "The delay before a transfer of data begins following an instruction for its transfer.",
                explanation: "Latency is the time delay between the cause and effect of some physical change in the system being observed. In networking, it's the time it takes for a data packet to travel from one point to another.",
                topic: "Network Concepts"
            },


            // Short Answer Questions (SAQ)
            {
                type: "saq",
                question: "List any three differences between a Hub and a Switch.",
                modelAnswer: "1. **Intelligence**: Switches are intelligent and read frame information (MAC addresses) to forward data to specific ports, while hubs are unintelligent and broadcast data to all ports. \n2. **Bandwidth**: Each port on a switch gets a dedicated amount of bandwidth, allowing multiple conversations concurrently, whereas all computers connected to a hub share the same total bandwidth. \n3. **Collision Domains**: Switches create separate collision domains for each port, reducing collisions, while hubs operate in a single collision domain, leading to more collisions and network congestion.",
                topic: "Networking Devices"
            },
            {
                type: "saq",
                question: "List any two differences between a Hub and a Router.",
                modelAnswer: "1. **Layer of Operation**: Hubs operate at Layer 1 (Physical Layer) of the OSI model, simply repeating signals. Routers operate at Layer 3 (Network Layer) and use IP addresses to route packets between different networks. \n2. **Network Connectivity**: Hubs connect devices within a single local area network (LAN). Routers connect different networks (LANs, WANs) and are essential for internetworking. \n3. **Broadcasting**: Hubs forward broadcast messages to all ports. Routers, by default, do not forward broadcast messages across different networks, limiting broadcast domains.",
                topic: "Networking Devices"
            },
            {
                type: "saq",
                question: "What are packets and frames in network communication?",
                modelAnswer: "1. **Packets**: Packets are chunks of data with source and destination IP addresses added to them. They are processed by network protocols (like IP) and routed between networks by routers. \n2. **Frames**: Frames are packets with source and destination MAC addresses added to them, along with an error-checking code (trailer). NICs send and receive frames, which are used for communication within a local network segment.",
                topic: "Network Concepts"
            },
            {
                type: "saq",
                question: "Explain the concept of 'Virtual Memory'.",
                modelAnswer: "Virtual memory is a memory management capability of an operating system (OS) that uses hardware and software to allow a computer to compensate for physical memory shortages by temporarily transferring data from random access memory (RAM) to disk storage. It allows programs to run that require more memory than is physically available.",
                topic: "Operating Systems"
            },
            {
                type: "saq",
                question: "What is the purpose of a MAC address in network communication?",
                modelAnswer: "A MAC (Media Access Control) address is a unique physical address assigned to network interfaces for communications within a network segment. Its purpose is to identify a specific device on a local network, allowing frames to be delivered to the correct hardware interface.",
                topic: "Network Addressing"
            },
            {
                type: "saq",
                question: "Describe the function of a router in a network.",
                modelAnswer: "A router is a networking device that forwards data packets between computer networks. Routers perform the traffic directing functions on the Internet. Data packets are sent from one router to another through the internetwork until they reach their destination node. Routers analyze the destination IP address of a packet and use routing tables to determine the best path for forwarding the packet.",
                topic: "Routing"
            },
            {
                type: "saq",
                question: "What is the difference between IPv4 and IPv6?",
                modelAnswer: "IPv4 uses 32-bit addresses, allowing for approximately 4.3 billion unique addresses. IPv6 uses 128-bit addresses, providing a vastly larger address space (approximately $3.4 \times 10^{38}$ unique addresses). IPv6 also includes improvements like simplified header format, better support for mobile devices, and enhanced security features.",
                topic: "IP Addressing"
            },
            {
                type: "saq",
                question: "Explain what a 'subnet mask' is and its purpose.",
                modelAnswer: "A subnet mask is a 32-bit number that distinguishes the network address from the host address within an IP address. It works by dividing an IP address into two parts: the network address (used for routing packets between networks) and the host address (used to identify a specific device within that network). This allows for efficient routing and management of IP addresses within a network.",
                topic: "IP Addressing"
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = []; // Stores user's selected answer or SAQ object {answer: "", status: ""}
        let score = 0;
        let correctAnswersCount = 0;
        let incorrectAnswersCount = 0;
        let unansweredCount = 0;
        let missedTopics = new Set(); // To store unique topics of missed questions

        // Get DOM elements
        const startScreen = document.getElementById('startScreen');
        const quizArea = document.getElementById('quizArea');
        const resultScreen = document.getElementById('resultScreen');
        const startButton = document.getElementById('startButton');
        const questionCounter = document.getElementById('questionCounter');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const shortAnswerInput = document.getElementById('shortAnswerInput');
        const selfMarkSection = document.getElementById('selfMarkSection');
        const modelAnswerDiv = document.getElementById('modelAnswer');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const submitQuizButton = document.getElementById('submitQuiz');
        const finalScore = document.getElementById('finalScore');
        const feedbackMessage = document.getElementById('feedbackMessage');
        const restartButton = document.getElementById('restartButton');
        const messageBox = document.getElementById('messageBox');
        const messageBoxTitle = document.getElementById('messageBoxTitle');
        const messageBoxContent = document.getElementById('messageBoxContent');
        const messageBoxClose = document.getElementById('messageBoxClose');
        const homeButton = document.getElementById('homeButton');
        const summaryChart = document.getElementById('summaryChart');
        const explanationBox = document.getElementById('explanationBox'); // New explanation box
        const detailedReviewSection = document.getElementById('detailedReviewSection');
        const reviewItemsContainer = document.getElementById('reviewItemsContainer');
        const revisionSuggestionsSection = document.getElementById('revisionSuggestionsSection');
        const revisionTopicsList = document.getElementById('revisionTopicsList');


        // Shuffle questions for a new session
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Display a custom message box instead of alert()
        function showMessageBox(title, message) {
            messageBoxTitle.textContent = title;
            messageBoxContent.textContent = message;
            messageBox.style.display = 'block';
        }

        // Close message box
        messageBoxClose.addEventListener('click', () => {
            messageBox.style.display = 'none';
        });

        // Initialize quiz
        function startQuiz() {
            shuffleArray(quizQuestions); // Shuffle questions at the start of each session
            currentQuestionIndex = 0;
            userAnswers = Array(quizQuestions.length).fill(null); // Initialize user answers array
            score = 0;
            correctAnswersCount = 0;
            incorrectAnswersCount = 0;
            unansweredCount = 0;
            missedTopics.clear(); // Clear missed topics for a new quiz

            startScreen.style.display = 'none';
            quizArea.style.display = 'flex';
            resultScreen.style.display = 'none';
            loadQuestion();
        }

        // Load and display current question
        function loadQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            questionCounter.textContent = `Question ${currentQuestionIndex + 1} of ${quizQuestions.length}`;
            questionText.textContent = question.question;

            optionsContainer.innerHTML = ''; // Clear previous options
            shortAnswerInput.style.display = 'none';
            selfMarkSection.style.display = 'none'; // Hide self-marking section by default
            explanationBox.style.display = 'none'; // Hide explanation box by default

            if (question.type === "mcq") {
                optionsContainer.style.display = 'flex';
                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.classList.add('option-button');
                    button.textContent = option;
                    button.dataset.index = index;
                    // Attach event listener only if not already answered
                    if (userAnswers[currentQuestionIndex] === null || userAnswers[currentQuestionIndex].selectedOption === undefined) {
                        button.addEventListener('click', () => selectOption(option, button));
                    }
                    optionsContainer.appendChild(button);
                });

                // If already answered, apply marking and disable options
                if (userAnswers[currentQuestionIndex] !== null && userAnswers[currentQuestionIndex].selectedOption !== undefined) {
                    applyMarkingAndDisableOptions(question);
                    // Show explanation if it was an MCQ and already answered
                    if (question.explanation) {
                        explanationBox.textContent = question.explanation;
                        explanationBox.style.display = 'block';
                    }
                }
                nextButton.style.display = 'none'; // Hide next button until answer is marked
                submitQuizButton.style.display = 'none'; // Hide submit button until answer is marked

            } else if (question.type === "saq") {
                optionsContainer.style.display = 'none';
                shortAnswerInput.style.display = 'block';
                shortAnswerInput.value = userAnswers[currentQuestionIndex]?.answer || ''; // Load saved answer

                // Show self-marking section if an answer exists
                if (userAnswers[currentQuestionIndex] !== null && userAnswers[currentQuestionIndex].answer !== undefined) {
                    displaySelfMarking(question.modelAnswer);
                }
            }

            updateNavigationButtons();
        }

        // Handle MCQ option selection and immediate marking
        function selectOption(selectedOption, clickedButton) {
            const currentQuestion = quizQuestions[currentQuestionIndex];

            // Store the user's answer
            userAnswers[currentQuestionIndex] = {
                selectedOption: selectedOption,
                status: null, // Will be 'correct' or 'incorrect'
                questionText: currentQuestion.question, // Store question text for review
                correctAnswer: currentQuestion.correctAnswer, // Store correct answer for review
                explanation: currentQuestion.explanation, // Store explanation for review
                topic: currentQuestion.topic // Store topic for revision suggestions
            };

            // Check if the answer is correct
            if (selectedOption === currentQuestion.correctAnswer) {
                clickedButton.classList.add('correct');
                userAnswers[currentQuestionIndex].status = 'correct';
            } else {
                clickedButton.classList.add('incorrect');
                userAnswers[currentQuestionIndex].status = 'incorrect';
                // Highlight the correct answer if the user was wrong
                Array.from(optionsContainer.children).forEach(button => {
                    if (button.textContent === currentQuestion.correctAnswer) {
                        button.classList.add('correct');
                    }
                });
            }

            // Disable all options after selection
            Array.from(optionsContainer.children).forEach(button => {
                button.classList.add('disabled');
                button.removeEventListener('click', () => selectOption(option, button)); // Remove event listener
            });

            // Display explanation
            if (currentQuestion.explanation) {
                explanationBox.textContent = currentQuestion.explanation;
                explanationBox.style.display = 'block';
            }

            // Show the next button immediately after marking
            nextButton.style.display = 'inline-block';
            if (currentQuestionIndex === quizQuestions.length - 1) {
                submitQuizButton.style.display = 'inline-block';
                nextButton.style.display = 'none'; // Hide next button if it's the last question
            }
        }

        // Apply visual marking and disable options for already answered MCQs
        function applyMarkingAndDisableOptions(question) {
            const userAnswer = userAnswers[currentQuestionIndex];
            Array.from(optionsContainer.children).forEach(button => {
                button.classList.add('disabled'); // Disable all options
                button.removeEventListener('click', () => selectOption(button.textContent, button)); // Remove event listener

                if (button.textContent === userAnswer.selectedOption) {
                    if (userAnswer.status === 'correct') {
                        button.classList.add('correct');
                    } else {
                        button.classList.add('incorrect');
                    }
                }
                // Always show the correct answer if it's an MCQ and already answered
                if (button.textContent === question.correctAnswer) {
                    button.classList.add('correct');
                }
            });
        }

        // Display self-marking section for SAQ
        function displaySelfMarking(modelAnswer) {
            selfMarkSection.style.display = 'block';
            modelAnswerDiv.innerHTML = modelAnswer.replace(/\n/g, '<br>'); // Display model answer with line breaks

            // Check if the question was already marked
            const userAnswerStatus = userAnswers[currentQuestionIndex]?.status;

            // Reset button states
            selfMarkSection.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('selected-mark'); // Remove previous selected state
            });

            if (userAnswerStatus === 'correct') {
                selfMarkSection.querySelector('.correct-mark').classList.add('selected-mark');
            } else if (userAnswerStatus === 'incorrect') {
                selfMarkSection.querySelector('.incorrect-mark').classList.add('selected-mark');
            }
        }

        // Handle self-marking for SAQ
        document.querySelectorAll('.self-mark-buttons button').forEach(button => {
            button.addEventListener('click', (event) => {
                const mark = event.target.dataset.mark;
                const currentQuestion = quizQuestions[currentQuestionIndex];

                // Ensure userAnswers[currentQuestionIndex] is an object for SAQ
                userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex] || {};
                userAnswers[currentQuestionIndex].answer = shortAnswerInput.value;
                userAnswers[currentQuestionIndex].status = mark; // Update user answer status
                userAnswers[currentQuestionIndex].questionText = currentQuestion.question;
                userAnswers[currentQuestionIndex].modelAnswer = currentQuestion.modelAnswer;
                userAnswers[currentQuestionIndex].topic = currentQuestion.topic;


                // Visually indicate selection
                selfMarkSection.querySelectorAll('button').forEach(btn => {
                    btn.classList.remove('selected-mark'); // Remove previous selected state
                });
                event.target.classList.add('selected-mark');

                // Show next/submit button after self-marking
                if (currentQuestionIndex < quizQuestions.length - 1) {
                    nextButton.style.display = 'inline-block';
                } else {
                    submitQuizButton.style.display = 'inline-block';
                }
            });
        });

        // Update navigation button visibility
        function updateNavigationButtons() {
            prevButton.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';

            const currentQuestion = quizQuestions[currentQuestionIndex];
            if (currentQuestion.type === "mcq") {
                // For MCQ, next/submit button depends on whether an answer has been selected
                if (userAnswers[currentQuestionIndex] !== null && userAnswers[currentQuestionIndex].selectedOption !== undefined) {
                    nextButton.style.display = (currentQuestionIndex === quizQuestions.length - 1) ? 'none' : 'inline-block';
                    submitQuizButton.style.display = (currentQuestionIndex === quizQuestions.length - 1) ? 'inline-block' : 'none';
                } else {
                    nextButton.style.display = 'none';
                    submitQuizButton.style.display = 'none';
                }
            } else if (currentQuestion.type === "saq") {
                // For SAQ, next/submit button depends on whether it has been self-marked
                if (userAnswers[currentQuestionIndex] !== null && userAnswers[currentQuestionIndex].status !== undefined) {
                    nextButton.style.display = (currentQuestionIndex === quizQuestions.length - 1) ? 'none' : 'inline-block';
                    submitQuizButton.style.display = (currentQuestionIndex === quizQuestions.length - 1) ? 'inline-block' : 'none';
                } else {
                    nextButton.style.display = 'none';
                    submitQuizButton.style.display = 'none';
                }
            }
        }

        // Go to previous question
        prevButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                // Save current SAQ answer before moving
                if (quizQuestions[currentQuestionIndex].type === "saq") {
                    userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex] || {};
                    userAnswers[currentQuestionIndex].answer = shortAnswerInput.value;
                }
                currentQuestionIndex--;
                loadQuestion();
            }
        });

        // Go to next question
        nextButton.addEventListener('click', () => {
            const currentQuestion = quizQuestions[currentQuestionIndex];
            if (currentQuestion.type === "mcq") {
                if (userAnswers[currentQuestionIndex] === null || userAnswers[currentQuestionIndex].selectedOption === undefined) {
                    showMessageBox('Warning', 'Please select an option before proceeding.');
                    return;
                }
            } else if (currentQuestion.type === "saq") {
                // Save SAQ answer
                userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex] || {};
                userAnswers[currentQuestionIndex].answer = shortAnswerInput.value;

                // If not self-marked, prompt user
                if (!userAnswers[currentQuestionIndex].status) {
                    displaySelfMarking(currentQuestion.modelAnswer);
                    showMessageBox('Self-Marking Required', 'Please review the model answer and self-mark your response before moving to the next question.');
                    return;
                }
            }

            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        });

        // Submit quiz and calculate score
        submitQuizButton.addEventListener('click', () => {
            const currentQuestion = quizQuestions[currentQuestionIndex];
            if (currentQuestion.type === "mcq") {
                if (userAnswers[currentQuestionIndex] === null || userAnswers[currentQuestionIndex].selectedOption === undefined) {
                    showMessageBox('Warning', 'Please select an option before submitting the quiz.');
                    return;
                }
            } else if (currentQuestion.type === "saq") {
                userAnswers[currentQuestionIndex] = userAnswers[currentQuestionIndex] || {};
                userAnswers[currentQuestionIndex].answer = shortAnswerInput.value;
                if (!userAnswers[currentQuestionIndex].status) {
                    displaySelfMarking(currentQuestion.modelAnswer);
                    showMessageBox('Self-Marking Required', 'Please review the model answer and self-mark your response before submitting the quiz.');
                    return;
                }
            }

            calculateScore();
            quizArea.style.display = 'none';
            resultScreen.style.display = 'flex';
            renderSummaryChart(); // Render the chart when results are shown
            renderDetailedReview(); // Render the detailed review
            renderRevisionSuggestions(); // Render revision suggestions
        });

        // Calculate final score and counts for summary
        function calculateScore() {
            score = 0;
            correctAnswersCount = 0;
            incorrectAnswersCount = 0;
            unansweredCount = 0;
            missedTopics.clear(); // Clear for recalculation

            quizQuestions.forEach((question, index) => {
                const userAnswerData = userAnswers[index];

                if (question.type === "mcq") {
                    if (userAnswerData && userAnswerData.status === 'correct') {
                        score++;
                        correctAnswersCount++;
                    } else if (userAnswerData && userAnswerData.status === 'incorrect') {
                        incorrectAnswersCount++;
                        if (question.topic) missedTopics.add(question.topic);
                    } else {
                        unansweredCount++;
                        if (question.topic) missedTopics.add(question.topic);
                    }
                } else if (question.type === "saq") {
                    if (userAnswerData && userAnswerData.status === 'correct') {
                        score++;
                        correctAnswersCount++;
                    } else if (userAnswerData && userAnswerData.status === 'incorrect') {
                        incorrectAnswersCount++;
                        if (question.topic) missedTopics.add(question.topic);
                    } else {
                        unansweredCount++;
                        if (question.topic) missedTopics.add(question.topic);
                    }
                }
            });

            finalScore.textContent = `Score: ${score}/${quizQuestions.length}`;
            if (score === quizQuestions.length) {
                feedbackMessage.textContent = "Excellent! You are a Network Ninja!";
                feedbackMessage.style.color = "#28a745";
            } else if (score >= quizQuestions.length * 0.7) {
                feedbackMessage.textContent = "Great job! You have a solid understanding.";
                feedbackMessage.style.color = "#555"; /* Adjusted for monochrome */
            } else {
                feedbackMessage.textContent = "Keep practicing! Review Chapter 3 to improve.";
                feedbackMessage.style.color = "#dc3545";
            }
        }

        // Render summary chart
        function renderSummaryChart() {
            summaryChart.innerHTML = ''; // Clear previous chart

            const totalQuestions = quizQuestions.length;

            const data = [
                { label: "Correct", count: correctAnswersCount, class: "correct" },
                { label: "Incorrect", count: incorrectAnswersCount, class: "incorrect" },
                { label: "Unanswered", count: unansweredCount, class: "unanswered" }
            ];

            data.forEach(item => {
                const percentage = totalQuestions > 0 ? (item.count / totalQuestions) * 100 : 0;

                const wrapper = document.createElement('div');
                wrapper.classList.add('chart-bar-wrapper');

                const label = document.createElement('span');
                label.classList.add('chart-label');
                label.textContent = item.label + ":";

                const bar = document.createElement('div');
                bar.classList.add('chart-bar', item.class);
                bar.style.width = `${percentage}%`;
                bar.textContent = `${item.count} (${percentage.toFixed(0)}%)`;

                wrapper.appendChild(label);
                wrapper.appendChild(bar);
                summaryChart.appendChild(wrapper);
            });
        }

        // Render detailed review of missed questions
        function renderDetailedReview() {
            reviewItemsContainer.innerHTML = ''; // Clear previous review items
            let hasMissedQuestions = false;

            quizQuestions.forEach((question, index) => {
                const userAnswerData = userAnswers[index];
                const isMissed = !userAnswerData || userAnswerData.status !== 'correct';

                if (isMissed) {
                    hasMissedQuestions = true;
                    const reviewItem = document.createElement('div');
                    reviewItem.classList.add('review-item');

                    const qText = document.createElement('p');
                    qText.classList.add('question-text-review');
                    qText.textContent = `Question ${index + 1}: ${question.question}`;
                    reviewItem.appendChild(qText);

                    const yourAnswer = document.createElement('p');
                    yourAnswer.classList.add('your-answer');

                    if (question.type === "mcq") {
                        yourAnswer.textContent = `Your Answer: ${userAnswerData ? userAnswerData.selectedOption : 'N/A'}`;
                        reviewItem.appendChild(yourAnswer);

                        const correctAnswer = document.createElement('p');
                        correctAnswer.classList.add('correct-answer');
                        correctAnswer.textContent = `Correct Answer: ${question.correctAnswer}`;
                        reviewItem.appendChild(correctAnswer);

                        if (question.explanation) {
                            const explanation = document.createElement('p');
                            explanation.classList.add('model-answer-review');
                            explanation.innerHTML = `Explanation: ${question.explanation}`;
                            reviewItem.appendChild(explanation);
                        }
                    } else if (question.type === "saq") {
                        yourAnswer.textContent = `Your Answer: ${userAnswerData ? userAnswerData.answer : 'N/A'}`;
                        reviewItem.appendChild(yourAnswer);

                        const modelAnswer = document.createElement('p');
                        modelAnswer.classList.add('model-answer-review');
                        modelAnswer.innerHTML = `Model Answer: ${question.modelAnswer.replace(/\n/g, '<br>')}`;
                        reviewItem.appendChild(modelAnswer);
                    }
                    reviewItemsContainer.appendChild(reviewItem);
                }
            });

            if (hasMissedQuestions) {
                detailedReviewSection.style.display = 'block';
            } else {
                detailedReviewSection.style.display = 'none';
            }
        }

        // Render revision suggestions based on missed topics
        function renderRevisionSuggestions() {
            revisionTopicsList.innerHTML = ''; // Clear previous topics

            if (missedTopics.size > 0) {
                revisionSuggestionsSection.style.display = 'block';
                missedTopics.forEach(topic => {
                    const listItem = document.createElement('li');
                    listItem.textContent = topic;
                    revisionTopicsList.appendChild(listItem);
                });
            } else {
                revisionSuggestionsSection.style.display = 'none';
            }
        }


        // Reset game to initial state (Home button functionality)
        function goToHome() {
            startScreen.style.display = 'flex';
            quizArea.style.display = 'none';
            resultScreen.style.display = 'none';
            currentQuestionIndex = 0;
            userAnswers = Array(quizQuestions.length).fill(null);
            score = 0;
            correctAnswersCount = 0;
            incorrectAnswersCount = 0;
            unansweredCount = 0;
            missedTopics.clear(); // Clear missed topics
            summaryChart.innerHTML = ''; // Clear chart
            explanationBox.style.display = 'none'; // Hide explanation box on home
            detailedReviewSection.style.display = 'none'; // Hide detailed review
            revisionSuggestionsSection.style.display = 'none'; // Hide revision suggestions
        }


        // Event listeners
        startButton.addEventListener('click', startQuiz);
        restartButton.addEventListener('click', startQuiz);
        homeButton.addEventListener('click', goToHome);

        // Initial setup
        window.onload = () => {
            startScreen.style.display = 'flex';
            quizArea.style.display = 'none';
            resultScreen.style.display = 'none';
        };
    </script>
</body>
</html>
